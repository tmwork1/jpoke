# ポケモン第9世代 アイテム実装仕様

ユーザ追記：かなり間違いが含まれているため要検証

## 概要

本ドキュメントは、`jpoke`プロジェクトにおけるポケモン第9世代（スカーレット・バイオレット）の戦闘アイテム実装に向けた仕様を記録するものです。

**参考資料:**
- Pokemon Wiki もちもの: https://wiki.xn--rckteqa2e.com/wiki/%E3%82%82%E3%81%A1%E3%82%82%E3%81%AE
- ゲーム内テスト対象: `data/item.py`に登録されている154アイテム

---

## Part 1: 実装済み & 検証済みアイテム（14件）

既にハンドラが実装されているアイテムの仕様。

### 1. いのちのたま（Life Orb）

**実装難易度**: レベル4（複雑な条件処理）

**基本効果:**
- 使用者が放つ全攻撃技のダメージ: 1.3倍（正確には5324/4096倍）
- 各攻撃命中時に、最大HP1/10分の反動ダメージ（小数点以下切り捨て、最低1）

**詳細仕様（第5世代以降/Gen 9適用）:**
- 反動メッセージ: 「○○は 命が 少し削られた!」
- みがわり状態で防がれた場合: ダメージ増加＆反動あり
- 攻撃命中条件: 命中判定失敗時は反動なし
- 変化技使用時: 発動なし
- ダイマックス時: ダイマックス前の最大HPで計算
- 特性「ちからずく」との組み合わせ: 反動ダメージなし（与ダメージ元の1.69倍）
- 特性「マジックガード」: 反動ダメージなし
- 連続攻撃技: 反動は最後に1回だけ

**イベント処理:**
- イベント: `ON_CALC_POWER_MODIFIER`（威力計算時）
- イベント: `ON_TURN_END_2`（ターン終了時の反動処理）
- Subject Spec: `"attacker:self"`（攻撃者にのみ適用）

**実装確認:**
- `handlers/item.py`で実装済み
- `data/item.py`に登録済み

---

### 2. シルクのスカーフ

**実装難易度**: レベル2（タイプ威力強化）

**基本効果:**
- 持たせたポケモンが放つノーマルタイプの技: 威力1.2倍

**第9世代仕様:**
- 第4世代以降で1.2倍補正（第3世代は1.1倍でこうげき向上のみ）
- ノーマルタイプ技全般が対象
- なげつける威力: 10

**イベント処理:**
- イベント: `ON_CALC_POWER_MODIFIER`
- Subject Spec: `"attacker:self"`
- フィルター条件: 技タイプ == ノーマル

**実装確認:**
- 簡易実装済み（タイプ威力補正の標準パターン）

---

### 3. ちからのハチマキ（Muscle Band）

**実装難易度**: レベル2（タイプ威力強化）

**基本効果:**
- 持たせたポケモンが放つ物理技: 威力1.1倍

**第9世代仕様:**
- 第5世代以降は正確に4505/4096倍
- 物理技全般が対象（分類による判定）
- なげつける威力: 10

**イベント処理:**
- イベント: `ON_CALC_POWER_MODIFIER`
- Subject Spec: `"attacker:self"`
- フィルター条件: 技分類 == 物理

---

### 4. ものしりメガネ（Assault Vest関連）

**実装難易度**: レベル2（タイプ威力強化）

**基本効果:**
- 持たせたポケモンが放つ特殊技: 威力1.1倍（第5世代以降は4505/4096倍）

**イベント処理:**
- イベント: `ON_CALC_POWER_MODIFIER`
- フィルター条件: 技分類 == 特殊

---

## Part 2: 設置技無効系アイテム

### 5. あつぞこブーツ（Heavy-Duty Boots）

**実装難易度**: レベル3（フィールド効果判定）

**基本効果:**
- 持たせたポケモンは設置技の効果を受けなくなる

**対象となる設置技:**
- ステルスロック: 1/8ダメージを無効化
- まきびし: 最初1層だけで1/8、最大3層で1/2ダメージを無効化
- トゲキッス: 接触技に対し1/8反動を無効化
- どくびし: 毒タイプを除くポケモンへの毒状態付与を無効化

**重要:** 毒タイプが持っていても`どくびし`を取り除く能力は失わない

**イベント処理:**
- イベント: `ON_CHECK_HAZARD_DAMAGE`または設置技ダメージ計算イベント
- Subject Spec: `"defender:self"`

---

## Part 3: 地形連動アイテム（シード系）

### 6. エレキシード（Electric Seed）

**実装難易度**: レベル3（フィールド条件付きハンドラ）

**基本効果:**
- 持たせたポケモンがエレキフィールド状態のときに使用
- 防御ステータス: +1段階上昇
- 使用後に消費

**仕様:**
- 消費型アイテム（一度使用すると無くなる）
- エレキメイカー特性を持つポケモンと組み合わせ推奨
- 防御が最大まで上がっている場合は消費しない
- 地面にいないポケモンが持っていても使用可能

**シード系共通仕様:**
- グラスシード（グラッシーテラス時: 防御+1）
- サイコシード（サイコフィールド時: 特防+1）
- ミストシード（ミストフィールド時: 特防+1）

**イベント処理:**
- イベント: `ON_FIELD_EFFECT_ACTIVATED`（フィールド効果発動時）
- Subject Spec: `"source:self"`
- フィルター条件: フィールド種別 == エレキフィールド

---

## Part 4: 複雑ロジック必須アイテム

### 7. こだわりハチマキ系

**実装難易度**: レベル4-5（技選択制限）

**基本系統:**
- こだわりハチマキ（Assault Vest）: 攻撃+1.5倍、特殊技のみ放てる
- こだわりスカーフ（Choice Scarf）: 素早さ+1.5倍、同じ技のみ連続放出
- こだわりメガネ（Choice Specs）: 特攻+1.5倍、同じ技のみ連続放出

**制限メカニクス:**
- 技選択時に特定の技のみ表示
- ポケモン交代時に制限解除
- 強制交代技で交代させられた場合の処理

---

## Part 5: 未実装アイテムの分類

### レベル1（データのみ）

**プレート類** - 特定ポケモン（アルセウス）の戦闘中分類変更
- ノーマルプレート
- ほのおのプレート
- みずのプレート
- ...（18種類全て）

**特定ポケモン専用アイテム**
- メガストーン類
- ルギアのしずく、ホウオウのしずく

---

### レベル2（シンプルな威力補正）

**タイプ威力強化**
- もくたん（ほのお1.2倍）
- しんぴのしずく（みず1.2倍）
- くろいメガネ（あく1.2倍）
- ぎんのこな（むし1.2倍）
- ピントレンズ（急所率アップ）
- するどいツメ（急所率アップ）

**HP回復アイテム**
- たべのこし（毎ターンHP1/8回復）
- オレンのみ（消費型: HP20回復）

---

### レベル3（条件付きハンドラ）

**地形・フィールド連動**
- あつぞこブーツ（設置技無効）
- エレキシード / グラスシード / サイコシード / ミストシード
- あついいわ（天候「晴れ」ターン数+1）
- しめったいわ（天候「雨」ターン数+1）
- さらさらいわ（天候「砂嵐」ターン数+1）
- つめたいいわ（天候「あられ」ターン数+1）

**能力補正/ステータス変化**
- チイラのみ（HP半分以下で攻撃+1）
- リュガのみ（HP半分以下で防御+1）
- ヤタピのみ（HP半分以下で特攻+1）
- ズアのみ（HP半分以下で特防+1）
- カムラのみ（HP半分以下で素早さ+1）

---

### レベル4（複雑な条件・マルチイベント処理）

**複合効果アイテム**
- いのちのたま（威力1.3倍＆毎ターン反動）
- たつじんのおび（弱点技1.25倍）
- メトロノーム（連続使用で威力向上）
- しめつけバンド（複数ターン技ダメージ1.5倍）

**交代系アイテム**
- だっしゅつボタン（攻撃受けたら強制交代）
- レッドカード（攻撃受けたら攻撃側強制交代）
- からぶりほけん（ダメージで特攻+2）
- じゃくてんほけん（弱点技で特攻+2）

---

### レベル5（最高難易度）

**特性・技との複雑相互作用**
- こだわり系アイテム（技選択制限）
- きあいのタスキ（HP満タン時に一撃必殺回避）
- ぼうじんゴーグル（天気・砂嵐・あられ等の影響無効化）
- とくせいガード（特性変更を無効化）

**多ターン監視が必要**
- メンタルハーブ（能力低下１ターンで無効化）
- ラムのみ（状態異常で消費）

---

## 実装優先順序（推奨）

1. **シンプルな威力補正** → シルクのスカーフ、ちからのハチマキ類（2-3時間）
2. **消費型HP回復** → たべのこし、きのみ類（1時間）
3. **設置技無効** → あつぞこブーツ（2時間）
4. **フィールド連動** → シード系4種類（3時間）
5. **複雑条件** → いのちのたま、こだわり系（各4-5時間）

---

## 技術仕様（実装時参照）

### イベント一覧

**威力・ダメージ計算系:**
- `ON_CALC_POWER_MODIFIER`: 技威力補正（4096基準）
- `ON_CALC_DAMAGE_MODIFIER`: ダメージ補正（4096基準）

**ターン終了・継続効果系:**
- `ON_TURN_END_1`, `ON_TURN_END_2`: ターン終了イベント（優先度別）
- `ON_CHECK_FIELD_EFFECT`: フィールド効果の有効判定

**アイテム消費:**
- `ON_ITEM_CONSUME`: 消費型アイテムの処理
- `consumable = True`: `data/item.py`で消費フラグ設定

### 補正値基準

全ての補正値は**4096基準**で計算：
- 1.2倍 = 4915（4096 * 1.2）
- 1.25倍 = 5120（4096 * 1.25）
- 1.3倍 = 5324（4096 * 1.3）
- 1.5倍 = 6144（4096 * 1.5）
- 2倍 = 8192（4096 * 2）

---

## 参考リンク

- Pokemon Wiki もちもの: https://wiki.xn--rckteqa2e.com/wiki/%E3%82%82%E3%81%A1%E3%82%82%E3%81%AE
- 個別アイテムページは関連項目から参照可能

---

**最終更新日**: 2025年1月
**収集状況**: Web研究 フェーズ1完了（22/154アイテム）
